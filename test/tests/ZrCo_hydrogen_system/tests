[Tests]
  design = 'InterfaceDiffusion.md ADMatInterfaceReactionZrCoHxPCT.md MatDiffusion.md TimeDerivative.md'
  issues = '#366'
  [ZrCoHx_PCT_csv]
    type = CSVDiff
    input = ZrCoHx_PCT
    csvdiff = ZrCoHx_PCT_out.csv
    max_parallel = 1 # see #200
    requirement = 'The system shall be able to model the PCT curves of ZrCoHx to determine the surface atomic fraction as a function of pressure and temperature.'
  []
  [ZrCoHx_PCT_exodus]
    type = Exodiff
    input = ZrCoHx_PCT.i
    exodiff = ZrCoHx_PCT_out.e
    prereq = ZrCoHx_PCT_csv
    should_execute = false # this test relies on the output files from ZrCoHx_PCT_csv, so it shouldn't be run twice
    requirement = 'The system shall be able to model the PCT curves of ZrCoHx to determine the surface atomic fraction as a function of pressure and temperature and generate an exodus file.'
  []
  ##  HIGH PRESSURE TESTING #####################
  [ZrCoHx_PCT_T433_1E4P_csv]
    type = CSVDiff
    input =ZrCoHx_PCT.i
    cli_args = 'output_file_base=ZrCoHx_PCT_T433_1E4P_out
                temperature=433.15
                initial_pressure_H2_enclosure_1=1e4
                initial_atomic_fraction=1.65
                Executioner/num_steps=200'
    csvdiff = ZrCoHx_PCT_T433_1E4P_out.csv
    requirement = 'The system shall be able to model the PCT curves of ZrCoHx to determine the surface atomic fraction as a function of pressure and temperature for P=1e4 Pa and T=433.15 K.'
  []
  [ZrCoHx_PCT_T433_3E4P_csv]
    type = CSVDiff
    input =ZrCoHx_PCT.i
    cli_args = 'output_file_base=ZrCoHx_PCT_T433_3E4P_out
                temperature=433.15
                initial_pressure_H2_enclosure_1=3e4
                initial_atomic_fraction=1.85
                Executioner/num_steps=200'
    csvdiff = ZrCoHx_PCT_T433_3E4P_out.csv
    requirement = 'The system shall be able to model the PCT curves of ZrCoHx to determine the surface atomic fraction as a function of pressure and temperature for P=3e4 Pa and T=433.15 K.'
  []
  [ZrCoHx_PCT_T604_5E4P_csv]
    type = CSVDiff
    input =ZrCoHx_PCT.i
    cli_args = 'output_file_base=ZrCoHx_PCT_T604_5E4P_out
                temperature=573.15
                initial_pressure_H2_enclosure_1=1e3
                initial_atomic_fraction=1.41
                Executioner/num_steps=200'
    csvdiff = ZrCoHx_PCT_T604_5E4P_out.csv
    max_parallel = 1 # see #200
    requirement = 'The system shall be able to model the PCT curves of ZrCoHx to determine the surface atomic fraction as a function of pressure and temperature for P=1e3 Pa and T=573.15 K.'
  []
    [ZrCoHx_PCT_T573_1E4P_csv]
    type = CSVDiff
    input =ZrCoHx_PCT.i
    cli_args = 'output_file_base=ZrCoHx_PCT_T573_1E4P_out
                temperature=573.15
                initial_pressure_H2_enclosure_1=1e4
                initial_atomic_fraction=1.41
                Executioner/num_steps=200'
    csvdiff = ZrCoHx_PCT_T573_1E4P_out.csv
    max_parallel = 1 # see #200
    requirement = 'The system shall be able to model the PCT curves of ZrCoHx to determine the surface atomic fraction as a function of pressure and temperature for P=1e4 Pa and T=573.15 K.'
  []
    ##  LOW PRESSURE TESTING #####################
   [ZrCoHx_PCT_T573_1E3P_csv]
    type = CSVDiff
    input =ZrCoHx_PCT.i
    cli_args = 'output_file_base=ZrCoHx_PCT_T573_1E3P_out
                temperature=573.15
                initial_pressure_H2_enclosure_1=1e3
                initial_atomic_fraction=0.4
                Executioner/num_steps=200'
    csvdiff = ZrCoHx_PCT_T573_1E3P_out.csv
    max_parallel = 1 # see #200
    requirement = 'The system shall be able to model the PCT curves of ZrCoHx to determine the surface atomic fraction as a function of pressure and temperature for P=1e3 Pa and T=573.15 K.'
  []
   [ZrCoHx_PCT_T604_1E4P_csv] 
    type = CSVDiff
    input =ZrCoHx_PCT.i
    cli_args = 'output_file_base=ZrCoHx_PCT_T604_1E4P_out
                temperature=604.15
                initial_pressure_H2_enclosure_1=1e4
                initial_atomic_fraction=0.45
                Executioner/num_steps=300'
    csvdiff = ZrCoHx_PCT_T604_1E4P_out.csv
    max_parallel = 1 # see #200
    requirement = 'The system shall be able to model the PCT curves of ZrCoHx to determine the surface atomic fraction as a function of pressure and temperature for P=1e4 Pa and T=604.15 K.'
  []
   [ZrCoHx_PCT_T604_6E3P_csv]
    type = CSVDiff
    input =ZrCoHx_PCT.i
    cli_args = 'output_file_base=ZrCoHx_PCT_T604_6E3P_out
                temperature=604.15
                initial_pressure_H2_enclosure_1=6e3
                initial_atomic_fraction=0.4
                Executioner/num_steps=200'
    csvdiff = ZrCoHx_PCT_T604_6E3P_out.csv
    max_parallel = 1 # see #200
    requirement = 'The system shall be able to model the PCT curves of ZrCoHx to determine the surface atomic fraction as a function of pressure and temperature for P=6e3 Pa and T=604.15 K.'
  []
   [ZrCoHx_PCT_T433_1E2P_csv]
    type = CSVDiff
    input =ZrCoHx_PCT.i
    cli_args = 'output_file_base=ZrCoHx_PCT_T433_1E2P_out
                temperature=433.15
                initial_pressure_H2_enclosure_1=1e2
                initial_atomic_fraction=0.3
                Executioner/num_steps=200'
    csvdiff = ZrCoHx_PCT_T433_1E2P_out.csv
    max_parallel = 1 # see #200
    requirement = 'The system shall be able to model the PCT curves of ZrCoHx to determine the surface atomic fraction as a function of pressure and temperature for P=1e2 Pa and T=433.15 K.'
  []
  ############## END OF LOW PRESSURE TESTING
  [ZrCoHx_PCT_comparison]
    type = RunCommand
    command = 'python3 comparison_ZrCoHx_PCT.py'
    requirement = 'The system shall be able to generate comparison plots between experimental PCT curves of ZrCoHx, the model used in TMAP8, and TMAP8 predictions.'
    required_python_packages = 'matplotlib numpy pandas os git'
  []
  [ZrCoHx_PCT_error_low_pressure]
    type = RunException
    input =ZrCoHx_PCT.i
    cli_args = 'initial_pressure_H2_enclosure_1=0.01'
    expect_err = 'In ZrCoHxPCT: pressure'
    requirement = 'The system shall be able to return a warning when the pressure and temperature are outside the range of validity of the ZrCoHxPCT model (pressure too low).'
  []
  [ZrCoHx_PCT_error_high_pressure]
    type = RunException
    input =ZrCoHx_PCT.i
    cli_args = 'initial_pressure_H2_enclosure_1=1e7'
    expect_err = 'In ZrCoHxPCT: pressure'
    requirement = 'The system shall be able to return a warning when the pressure and temperature are outside the range of validity of the ZrCoHxPCT model (pressure too high).'
  []
[]
